## 수평 스케일링 vs 수직 스케일링

### 단일 서버 설계(Single-Server Design)
<img width="510" alt="단일서버설계" src="https://user-images.githubusercontent.com/107941880/223420159-ed52a1b9-8e84-4d0d-a62e-809c3cf16f5f.png">

- 상황
    - 세계 곳곳에 시스템에 접속하려는 고객이 있고, 시스템과 인터넷으로 연결되어 있다(전 세계 어딘가로 라우팅되고 있다)
    - 서버 자체에 데이터베이스가 있다.
- 문제 : 호스트 → 단일 장애점이 된다
    - 서버기 다운되면, 새로운 서버를 공급해야 한다.
    - 백업에 있는 모든 것을 복원해야 하고, DNS 엔트리를 새 서버를 가리키도록 바꿔서 사람들이 접속하도록 해야 한다.
- 1차 해결법 : 데이터베이스를 분리한다
    - 단일 HTTP 서버와 데이터베이스를 분리하면, 서버와 데이터베이스를 독립적으로 확장할 수 있다.
    - 이제 컴퓨터는 2대가 되었고, 이를 통해 리소스를 분산하고 독립적으로 확장할 수 있다.
- 문제 : 두 서버 모두 단일 장애점이다
    - 데이터베이스가 다운되면 웹사이트도 다운된다.
    - 웹 서버가 다운되면 웹사이트가 다운된다.
    - 복원의 관점에서는 좋은 것이 없다.

### 수직적 확장(Vertical Scaling)
<img width="510" alt="수직적확장" src="https://user-images.githubusercontent.com/107941880/223420243-2305ac8d-413d-4656-803a-0d91a44c29a4.png">

- 상황
    - 기존 1개의 서버에서 처리 가능한 트래픽보다 더 많은 트래픽을 원한다고 가정
    - 더 큰 서버를 투입해야 한다 → 수직 스케일링
- 수직 스케일링
    - 서버를 추가하는 대신 더 큰 서버를 추가하는 것이다.
    - 데이터베이스 서버를 더 크게 만들 수도 있다.
- 장점
    - 2개의 호스트만 신경 쓰면 되기 때문에 유지 보수할 것이 많지 않다.
    - 컴퓨터 수가 적고 서버 수가 적을수록 언젠가 문제가 발생할 가능성도 적어진다.
- 문제 : 여전히 단일 장애점이 있다.

### 수평적 확장(Horizontal Scaling)
<img width="510" alt="수평적확장" src="https://user-images.githubusercontent.com/107941880/223420203-62f6a1d9-0c0e-4937-8ce9-d44870be2a33.png">

- 수평적 확장
    - 단일 서버 대신 여러 서버를 가진다.
    - 인터넷과 서버 사이의 로드 밸런서로 인터넷으로 들어오는 부하를 전체 서버의 플릿으로 공평하고 일정하게 분산한다.
    - 그래서 서버 중 하나가 다운되어도 공급된 초과 용량이 충분하면 신경쓰지 않아도 되는 장점이 있다.
    - 로드 밸런서가 호스트가 다운된 것을 인지해, 다운 시간이 없도록 주변 트래픽을 리(Re)라우팅한다.
    - 트래픽이 증가할수록 플릿에 더 많은 서버를 추가하고, 로드 밸랜서가 그 트래픽을 서버 간에 분산시킨다.
- 장점 : 더 많은 서버를 배치할수록 더 많은 트래픽을 처리할 수 있으며, 사실상 무한히 확장 가능하다.
- 문제 : 유지 보수할 것이 많다.

> 💡 상태 저장(stateful) vs 상태 비 저장(stateless)

- 수평적 확장은 웹 서버가 상태 비 저장(stateless) 서버일 경우에만 제대로 작동한다
- 데이터베이스로 하나로 묶어서 히스토리를 갖는 것은 괜찮지만, 어떤 개별 서버도 해당 서버가 어떤 사용자의 이전 요청을 제공한 서버라고 가정할 수 없다.
- 이전 요청이 어디로 라우팅 됐는지 모르기 때문이다.
- 그래서 어떤 서버에 어떤 사용자의 이전 접속에 관한 정보가 없으며, 비 저장 상태의 웹 서버는 언제든지 모든 요청을 처리할 수 있음을 의미한다.

> 💡 서버는 어디에 있을까?

- 기업 내 데이터 센터
- 클라우드 서비스
    - Amazon EC2(Elastic Compute Cloud)
    - 필요한 만큼 가상 머신(Virtual Machine)을 시간당으로 임대할 수 있다.
- 서버리스(Serverless) 서비스
    - Amazon Lambda : 실행할 코드의 일부만 제공해도 실행 위치를 파악한다.
    - Amazon Kinesis : 한 지점에서 다른 지점으로 스트리밍 데이터를 처리한다.
    - 서버 자체의 권한 설정이 숨겨져 있으며, 서비스를 얼마나 사용하고 있는지에 관해 트랜잭션 별로 비용을 청구한다.
    - 이런 서버를 실행하는 실제 서버를 확인하거나 제어할 수 없다.
